<style>
    .row{
        justify-content: center;
    }
</style>

<form class="container-fluid" onsubmit="return false">
    <div class="container-cad">
        <div class="row">
            <div class="form-group col-2" >
                <label>Data Recebimento</label>
                <input type="date" class="form-control" name="data_recebimento" id="data_recebimento" autocomplete="off"/>
            </div>
            <div class="form-group col-2" >
                <label>Data Vencimento</label>
                <input type="date" class="form-control" name="data_vencimento" id="data_vencimento" autocomplete="off"/>
            </div>
            <div class="form-group col-2" >
                <label>Tipo</label>
                <select class="form-control" name="tipo" id="tipo">
                    <option value="1">Crédito</option>
                    <option value="2">Débito</option>
                </select>
            </div>
            <div class="form-group col-2" >
                <label>Titular</label>
                <input type="text" class="form-control" name="titular" id="titular" autocomplete="off"/>
            </div>
        </div>
        <div class="row">
            <div class="form-group col-2" >
                <label>Número</label>
                <input type="text" class="form-control" name="numero" id="numero" autocomplete="off"/>
            </div>
            <div class="form-group col-2" >
                <label>Valor</label>
                <input type="text" class="form-control" name="valor" id="valor" autocomplete="off"/>
            </div>
            <div class="form-group col-2" >
                <label>Contato</label>
                <input type="text" placeholder="(DDD) 99999-9999" class="form-control" name="contato" id="contato" autocomplete="off"/>
            </div>
            <div class="form-group col-2">
                <label>Compensado</label>
                <input type="checkbox" class="form-control" name="compensado" id="compensado" autocomplete="off"/>
            </div>
        </div>
    </div>
    <div class="form-actions">
        <button type="button" class="button button-success cadastrar" type="button" onclick="cadastrar()">Salvar</button>
    </div>
</form>

<script>
    async function cadastrar(){
        let data = {
            numero              : document.getElementById("numero").value,
            data_recebimento    : document.getElementById("data_recebimento").value,
            data_vencimento     : document.getElementById("data_vencimento").value,
            valor               : (document.getElementById("valor").value ? Number(document.getElementById("valor").value.replaceAll(',', '.')) : 0),
            tipo                : document.getElementById("tipo").value,
            titular             : document.getElementById("titular").value,
            compensado          : document.getElementById("compensado").checked,
            contato             : document.getElementById("contato").value
        }
        console.log(data)
        await fetch('/api/cheques', 
            {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json;charset=utf-8'
                },
                body: JSON.stringify(data)
            }
        ).then((response)=>{
            console.log(response)
            response.json().then((retorno)=>{
                if(retorno && retorno.message == "error"){
                    alert("Erro ao cadastrar!")
                }else{
                    alert("Cadastrado com sucesso!");
                    window.location.reload();
                }
            }).catch((err)=>{
                alert("Erro ao cadastrar!")
            })
            
            //window.location.reload();
        }).catch((err)=>{
            alert("Erro ao cadastrar!")
        }); 
    }
</script>